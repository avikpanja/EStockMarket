<div>
    <div class="row m-0">
        <div class="col-sm-3"></div>
        <div class="col-sm-3"></div>
        <div class="col-sm-6">
            <mat-form-field class="search-form-field" floatLabel="never">
                <input type="text" matInput placeholder="Search" aria-label="Search" [(ngModel)]="searchedKey"
                    (keyup)="applyFilter()">
                <button mat-icon-button matSuffix aria-label="Clear" *ngIf="searchedKey" (click)="clearFilter()">
                    <mat-icon>close</mat-icon>
                </button>
            </mat-form-field>
        </div>
    </div>
    
    <div class="clearfix"></div>
    <div class="mat-elevation-z8">
        <mat-table [dataSource]="matDataSource" matSort>
            <ng-container matColumnDef="companyName">
                <mat-header-cell *matHeaderCellDef mat-sort-header>Company Name</mat-header-cell>
                <mat-cell *matCellDef="let element">
                    <!-- <a [routerLink]="['/stock', element.companyCode]"></a> -->
                    {{element.companyName}}
                </mat-cell>
            </ng-container>
            <ng-container matColumnDef="companyCode">
                <mat-header-cell *matHeaderCellDef mat-sort-header>Company Code</mat-header-cell>
                <mat-cell *matCellDef="let element">{{element.companyCode}}</mat-cell>
            </ng-container>
            <ng-container matColumnDef="ceo">
                <mat-header-cell *matHeaderCellDef mat-sort-header>CEO Name</mat-header-cell>
                <mat-cell *matCellDef="let element">{{element.ceo}}</mat-cell>
            </ng-container>
            <ng-container matColumnDef="turnover">
                <mat-header-cell *matHeaderCellDef mat-sort-header>Turnover</mat-header-cell>
                <mat-cell *matCellDef="let element">{{element.turnover}}</mat-cell>
            </ng-container>
            <ng-container matColumnDef="website">
                <mat-header-cell *matHeaderCellDef mat-sort-header>Website</mat-header-cell>
                <mat-cell *matCellDef="let element">{{element.website}}</mat-cell>
            </ng-container>
            <ng-container matColumnDef="stockExchange">
                <mat-header-cell *matHeaderCellDef mat-sort-header>Stock Exchange</mat-header-cell>
                <mat-cell *matCellDef="let element">{{element.stockExchange}}</mat-cell>
            </ng-container>
            <ng-container matColumnDef="stockPrice">
                <mat-header-cell *matHeaderCellDef mat-sort-header>Stock Price</mat-header-cell>
                <mat-cell *matCellDef="let element">{{element.stockPrice | number: '1.2-2'}}</mat-cell>
            </ng-container>
            <!-- Button Area -->
            <ng-container matColumnDef="actions">
                <mat-header-cell *matHeaderCellDef></mat-header-cell>
                <mat-cell *matCellDef="let row; let element">
                    <button mat-icon-button (click)="openCompanyUpdateModal(element.companyCode)">
                        <mat-icon>edit</mat-icon>
                    </button>
                    <button mat-icon-button (click)="openCompanyDeleteModal(element.companyCode)">
                        <mat-icon color="warn">delete_outline</mat-icon>
                    </button>
                    <button mat-icon-button [routerLink]="['/stock', element.companyCode]">
                        <mat-icon>launch</mat-icon>
                    </button>
                </mat-cell>
            </ng-container>

            <!-- <ng-container matColumnDef="loading">
            <mat-footer-cell *matFooterCellDef colspan="6">
                Loading data...
            </mat-footer-cell>
        </ng-container>-->
            <!-- <ng-container matColumnDef="noRecord">
            <mat-footer-cell *matFooterCellDef colspan="6">
                No record found
            </mat-footer-cell>
        </ng-container> -->
            <mat-header-row *matHeaderRowDef="companyTableHeaders"></mat-header-row>
            <mat-row *matRowDef="let row; columns: companyTableHeaders;"></mat-row>
            <!-- <mat-footer-row *matFooterRowDef="['loading']" [ngClass]="{'hide': true}"></mat-footer-row> -->
            <!-- <mat-footer-row *matFooterRowDef="['noRecord']" [ngClass]="{'hide': false}"></mat-footer-row> -->
        </mat-table>
        <mat-paginator [pageSizeOptions]="[2,5,10,25,100]" [pageSize]="5"></mat-paginator>
    </div>

    <!-- Old Dashboard -->
    <!-- <div id="dashboardDiv">
    <div>
        <div class="row">
            <div class="col-md-8">
                <h2><u><b>Stock Dashborad</b></u></h2>
            </div>
            <div class="col-md-4">
                <input id="compCode" type="text" placeholder="Enter company code" 
                [(ngModel)]="searchedCompanyCode">
                &nbsp;
                <button (click)="searchAComapny()">Search by code</button>
                &nbsp;
                <button (click)="viewAllCompany()">View all</button>
            </div>
        </div>
        <table class="table">
            <thead>
                <tr>
                    <th>Company Name</th>
                    <th>Company Code</th>
                    <th>Company CEO</th>
                    <th>Website</th>
                    <th>Stock Exchange</th>
                    <th>Turnover</th>
                    <th>Stock Price</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let comp of listOfCompany">
                    <td><a [routerLink]="['/stock', comp.companyCode]">{{comp.companyName}}</a></td>
                    <td>{{comp.companyCode}}</td>
                    <td>{{comp.ceo}}</td>
                    <td>{{comp.website}}</td>
                    <td>{{comp.stockExchange}}</td>
                    <td>{{comp.turnover}}</td>
                    <td>{{comp.stockPrice}}</td>
                    <td>
                        <button type="button" class="btn btn-outline-secondary btn-sm" 
                            (click)="deleteCompany(comp.companyCode)">Delete</button>
                        &nbsp;
                        <button type="button" class="btn btn-outline-secondary btn-sm" 
                            (click)="openCompanyUpdateModal(comp.companyCode)">Update</button>
                    </td>
                   
                </tr>
            </tbody>
        </table>
    </div>


</div> -->

    <!-- <div class="modal fade" id="stockPriceUpdateModal" tabindex="-1" role="dialog" hide>
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Update Stock Price</h3>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form #stockUpdateForm="ngForm">
                    <div class="form-group row">
                        <label for="spUpdtMdlCc" class="col-sm-4 col-form-label">
                            Code
                         </label>
                         <div class="col-sm-8">
                             <input id="spUpdtMdlCc" class="form-control col-md-10" type="text" name="companyCode" 
                                [(ngModel)]="stockModalData.companyCode" disabled>
                         </div>
                    </div>
                    <div class="form-group row">
                        <label for="spUpdtMdlSp" class="col-sm-4 col-form-label">
                            Stock Price
                         </label>
                         <div class="col-sm-8">
                            <input id="spUpdtMdlSp" class="form-control col-md-10" type="text" name="stockPrice" 
                                [(ngModel)]="stockModalData.stockPrice" placeholder="Stock price">
                         </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" (click)="updateStockPrice()">Save changes</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div> -->

</div>

<div class="modal fade bd-example-modal-lg" id="companyInfoUpdateModal" tabindex="-1" role="dialog" hide>
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header bg-dark">
                <h3 class="modal-title text-white">Update Company Info</h3>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span class="text-white" aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form #companyInfoUpdate="ngForm">
                    <div class="form-group row">
                        <label for="ciUpdtMdlcc" class="col-sm-4 col-form-label">
                            Company Code
                        </label>
                        <div class="col-sm-8">
                            <input id="ciUpdtMdlcc" class="form-control" type="text" name="companyCode"
                                [(ngModel)]="companyModalData.companyCode" disabled>
                        </div>
                    </div>

                    <div class="form-group row">
                        <label for="ciUpdtMdlcn" class="col-sm-4 col-form-label">
                            Company Name
                        </label>
                        <div class="col-sm-8">
                            <input id="ciUpdtMdlcn" class="form-control" type="text" name="companyName"
                                [(ngModel)]="companyModalData.companyName" placeholder="Company name" 
                                #name="ngModel" minlength="3" required>
                            <div *ngIf="name.touched && name.invalid && name.errors!=null" class="alert alert-danger" role="alert">
                                <div *ngIf="name.errors['minlength']">
                                    Minimum 3 character required!
                                </div>
                                <div *ngIf="name.errors['required']">
                                    Company name is required!
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group row">
                        <label for="ciUpdtMdlCo" class="col-sm-4 col-form-label">
                            Company CEO
                        </label>
                        <div class="col-sm-8">
                            <input id="ciUpdtMdlCo" class="form-control" type="text" name="ceo"
                                [(ngModel)]="companyModalData.ceo" placeholder="Ceo name"
                                #ceoName="ngModel" minlength="2" required>
                            <div *ngIf="ceoName.touched && ceoName.invalid && ceoName.errors!=null" class="alert alert-danger" role="alert">
                                <div *ngIf="ceoName.errors['minlength']">
                                    Minimum 2 character required!
                                </div>
                                <div *ngIf="ceoName.errors['required']">
                                    CEO name is required!
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group row">
                        <label for="ciUpdtMdlTo" class="col-sm-4 col-form-label">
                            Turnover
                        </label>
                        <div class="col-sm-8">
                            <input id="ciUpdtMdlTo" class="form-control" type="number" name="turnover"
                                [(ngModel)]="companyModalData.turnover" placeholder="Turnover amount"
                                #turnover="ngModel" min="100000000" required>
                            <div *ngIf="turnover.touched && turnover.invalid && turnover.errors!=null" class="alert alert-danger" role="alert">
                                <div *ngIf="turnover.errors['min']" >
                                    Minimum 10 crore required!
                                </div>
                                <div *ngIf="turnover.errors['required']">
                                    Turnover is required!
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group row">
                        <label for="ciUpdtMdlWs" class="col-sm-4 col-form-label">
                            Website
                        </label>
                        <div class="col-sm-8">
                            <input id="ciUpdtMdlWs" class="form-control" type="text" name="website"
                                [(ngModel)]="companyModalData.website" placeholder="www.domain.com"
                                #website="ngModel" required>
                            <div *ngIf="website.touched && website.invalid" class="alert alert-danger" role="alert">
                                Website is required!
                            </div>
                        </div>
                    </div>

                    <div class="form-group row">
                        <label for="ciUpdtMdlSe" class="col-sm-4 col-form-label">
                            Stock Exchange
                        </label>
                        <div class="col-sm-8">
                            <select class="form-control" id="ciUpdtMdlSe" name="stockExchange" required
                                [(ngModel)]="companyModalData.stockExchange">
                                <option *ngFor="let oneItem of stockExchangeList" [value]="oneItem">{{oneItem}}
                                </option>
                            </select>
                        </div>
                    </div>

                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" (click)="updateCompanyInfo()">Save changes</button>
                <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Delete Confirmation modal -->
<div class="modal fade bd-example-modal-sm" id="companyDeleteModal" tabindex="-1" role="dialog" hide>
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <div class="modal-body">
                <div class="form-group">
                    <p>Type <i>confirm delete</i> in the below box</p>
                    <input type="text" class="form-control col-lg-10" placeholder="confirm delete" [(ngModel)]="deleteConfirmation">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" (click)="deleteCompany()">Delete</button>
                <button type="button" class="btn btn-outline-secondary" data-dismiss="modal" (click)="closeCompanyDeleteModal()">Close</button>
            </div>
        </div>
    </div>
</div>